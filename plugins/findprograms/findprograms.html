<div class="panel-content find-programs">
    <h1><%= title %></h1>
    <ul class="nav nav-v js-accordion">
        <% _.each(categories, function(data, key) { %>
            <% if (data !== undefined) { %>
                <li class="nav-item">
                    <div class="name toogler expand touch-row">
                        <h3 class="program-title">
                            <a href="#">
                                <%= data.categoryName %>
                            </a>
                        </h3>
                        <div class="number-of-programs">
                            <%= data.programs.length %>
                        </div>
                        <a href="#" class="close toogler collapse touch-row" ><%= MM.lang.s("close") %></a>
                    </div>
                    <% if (data.subcategories.length > 0 || data.programs.length > 0) { %>
                    <ul class="nav submenu">
                        <% if (data.subcategories.length > 0) { %>
                        <% // Sub Categories %>
                        <li>
                            <h5><%= MM.lang.s("subcategories") %></h5>
                        </li>
                        <li>
                            <ul>
                                <% _.each(data.subcategories, function(subcat) { %>
                                <li>
                                    <a href="#find_programs/<%= subcat.attributes.id %>" class="sub-item-title">
                                        <%= subcat.attributes.name %>
                                        <%= subcat.attributes.programcount %>
                                    </a>
                                </li>
                                <% }); %>
                            </ul>
                        </li>
                        <% } %>
                        <% if (data.programs.length > 0) { %>
                        <% // Programs %>
                        <li>
                            <h5><%= MM.lang.s("programs") %></h6>
                        </li>
                        <li>
                            <ul>
                                <% _.each(data.programs, function(program) { %>
                                <li>
                                    <% // ToDo - Add check to see if user is enroled on program.  %>
                                    <a href="#programs/<%= program.id %>" class="sub-item-title">
                                        <%= program.fullname %>
                                    </a>
                                    <% // Currently always 'not-started' as not getting the correct data. %>
                                    <% if (program.started == 1) { %>
                                    <span class="completion-inprogress"></span>
                                    <% } else if (program.completed == 1) { %>
                                    <span class="completion-complete"></span>
                                    <% } else { %>
                                    <span class="completion-notstarted"></span>
                                    <% } %>
                                </li>
                                <% }); %>
                            </ul>
                        </li>
                        <% } %>
                    </ul>
                    <% } %>
                </li>
            <% } %>
        <% }); %>
    </ul>
</div>
